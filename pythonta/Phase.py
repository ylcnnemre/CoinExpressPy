import pandas as pd
import ephem
import json
data=[
                {
                    "time": "23.01.2024 03:00:00",
                    "open": "39568.02000000",
                    "close": "39897.60000000",
                    "volume": "57956.63351000"
                },
                {
                    "time": "24.01.2024 03:00:00",
                    "open": "39897.59000000",
                    "close": "40084.88000000",
                    "volume": "39293.82861000"
                },
                {
                    "time": "25.01.2024 03:00:00",
                    "open": "40084.89000000",
                    "close": "39961.09000000",
                    "volume": "31022.11853000"
                },
                {
                    "time": "26.01.2024 03:00:00",
                    "open": "39961.09000000",
                    "close": "41823.51000000",
                    "volume": "47384.96726000"
                },
                {
                    "time": "27.01.2024 03:00:00",
                    "open": "41823.51000000",
                    "close": "42120.63000000",
                    "volume": "16224.41667000"
                },
                {
                    "time": "28.01.2024 03:00:00",
                    "open": "42120.63000000",
                    "close": "42031.06000000",
                    "volume": "27294.99838000"
                },
                {
                    "time": "29.01.2024 03:00:00",
                    "open": "42031.05000000",
                    "close": "43302.70000000",
                    "volume": "31542.74207000"
                },
                {
                    "time": "30.01.2024 03:00:00",
                    "open": "43302.71000000",
                    "close": "42941.10000000",
                    "volume": "37619.24546000"
                },
                {
                    "time": "31.01.2024 03:00:00",
                    "open": "42941.10000000",
                    "close": "42580.00000000",
                    "volume": "39871.13688000"
                },
                {
                    "time": "01.02.2024 03:00:00",
                    "open": "42580.00000000",
                    "close": "43082.94000000",
                    "volume": "35231.04664000"
                },
                {
                    "time": "02.02.2024 03:00:00",
                    "open": "43082.95000000",
                    "close": "43200.00000000",
                    "volume": "29672.14418000"
                },
                {
                    "time": "03.02.2024 03:00:00",
                    "open": "43199.99000000",
                    "close": "43011.09000000",
                    "volume": "12033.40998000"
                },
                {
                    "time": "04.02.2024 03:00:00",
                    "open": "43011.10000000",
                    "close": "42582.88000000",
                    "volume": "17066.89404000"
                },
                {
                    "time": "05.02.2024 03:00:00",
                    "open": "42582.88000000",
                    "close": "42708.70000000",
                    "volume": "29467.75905000"
                },
                {
                    "time": "06.02.2024 03:00:00",
                    "open": "42708.70000000",
                    "close": "43098.95000000",
                    "volume": "24675.85433000"
                },
                {
                    "time": "07.02.2024 03:00:00",
                    "open": "43098.96000000",
                    "close": "44349.60000000",
                    "volume": "34392.59915000"
                },
                {
                    "time": "08.02.2024 03:00:00",
                    "open": "44349.60000000",
                    "close": "45288.65000000",
                    "volume": "45439.62231000"
                },
                {
                    "time": "09.02.2024 03:00:00",
                    "open": "45288.66000000",
                    "close": "47132.77000000",
                    "volume": "73503.48100000"
                },
                {
                    "time": "10.02.2024 03:00:00",
                    "open": "47132.78000000",
                    "close": "47751.09000000",
                    "volume": "24802.35936000"
                },
                {
                    "time": "11.02.2024 03:00:00",
                    "open": "47751.08000000",
                    "close": "48299.99000000",
                    "volume": "29958.80837000"
                },
                {
                    "time": "12.02.2024 03:00:00",
                    "open": "48300.00000000",
                    "close": "49917.27000000",
                    "volume": "59009.96705000"
                },
                {
                    "time": "13.02.2024 03:00:00",
                    "open": "49917.28000000",
                    "close": "49699.59000000",
                    "volume": "55551.56706000"
                },
                {
                    "time": "14.02.2024 03:00:00",
                    "open": "49699.60000000",
                    "close": "51795.17000000",
                    "volume": "57046.37401000"
                },
                {
                    "time": "15.02.2024 03:00:00",
                    "open": "51795.17000000",
                    "close": "51880.00000000",
                    "volume": "53816.03055000"
                },
                {
                    "time": "16.02.2024 03:00:00",
                    "open": "51880.01000000",
                    "close": "52124.11000000",
                    "volume": "37772.25318000"
                },
                {
                    "time": "17.02.2024 03:00:00",
                    "open": "52124.10000000",
                    "close": "51642.64000000",
                    "volume": "25674.00622000"
                },
                {
                    "time": "18.02.2024 03:00:00",
                    "open": "51642.64000000",
                    "close": "52137.67000000",
                    "volume": "21992.10363000"
                },
                {
                    "time": "19.02.2024 03:00:00",
                    "open": "52137.68000000",
                    "close": "51774.73000000",
                    "volume": "29534.99432000"
                },
                {
                    "time": "20.02.2024 03:00:00",
                    "open": "51774.74000000",
                    "close": "52258.82000000",
                    "volume": "49614.47318000"
                },
                {
                    "time": "21.02.2024 03:00:00",
                    "open": "52258.82000000",
                    "close": "51849.39000000",
                    "volume": "43079.40049000"
                },
                {
                    "time": "22.02.2024 03:00:00",
                    "open": "51849.38000000",
                    "close": "51288.42000000",
                    "volume": "35309.44574000"
                },
                {
                    "time": "23.02.2024 03:00:00",
                    "open": "51288.42000000",
                    "close": "50744.15000000",
                    "volume": "30545.79544000"
                },
                {
                    "time": "24.02.2024 03:00:00",
                    "open": "50744.15000000",
                    "close": "51568.22000000",
                    "volume": "16560.42110000"
                },
                {
                    "time": "25.02.2024 03:00:00",
                    "open": "51568.21000000",
                    "close": "51728.85000000",
                    "volume": "18721.63159000"
                },
                {
                    "time": "26.02.2024 03:00:00",
                    "open": "51728.85000000",
                    "close": "54476.47000000",
                    "volume": "51256.72199000"
                },
                {
                    "time": "27.02.2024 03:00:00",
                    "open": "54476.48000000",
                    "close": "57037.34000000",
                    "volume": "67194.98562000"
                },
                {
                    "time": "28.02.2024 03:00:00",
                    "open": "57037.35000000",
                    "close": "62432.10000000",
                    "volume": "118763.46984000"
                },
                {
                    "time": "29.02.2024 03:00:00",
                    "open": "62432.11000000",
                    "close": "61130.98000000",
                    "volume": "78425.07603000"
                },
                {
                    "time": "01.03.2024 03:00:00",
                    "open": "61130.99000000",
                    "close": "62387.90000000",
                    "volume": "47737.93473000"
                },
                {
                    "time": "02.03.2024 03:00:00",
                    "open": "62387.90000000",
                    "close": "61987.28000000",
                    "volume": "25534.73659000"
                },
                {
                    "time": "03.03.2024 03:00:00",
                    "open": "61987.28000000",
                    "close": "63113.97000000",
                    "volume": "28994.90903000"
                },
                {
                    "time": "04.03.2024 03:00:00",
                    "open": "63113.97000000",
                    "close": "68245.71000000",
                    "volume": "84835.16005000"
                },
                {
                    "time": "05.03.2024 03:00:00",
                    "open": "68245.71000000",
                    "close": "63724.01000000",
                    "volume": "132696.78130000"
                },
                {
                    "time": "06.03.2024 03:00:00",
                    "open": "63724.01000000",
                    "close": "66074.04000000",
                    "volume": "78738.85491000"
                },
                {
                    "time": "07.03.2024 03:00:00",
                    "open": "66074.04000000",
                    "close": "66823.17000000",
                    "volume": "53059.88690000"
                },
                {
                    "time": "08.03.2024 03:00:00",
                    "open": "66823.18000000",
                    "close": "68124.19000000",
                    "volume": "74261.93284200"
                },
                {
                    "time": "09.03.2024 03:00:00",
                    "open": "68124.20000000",
                    "close": "68313.27000000",
                    "volume": "19872.89743000"
                },
                {
                    "time": "10.03.2024 03:00:00",
                    "open": "68313.28000000",
                    "close": "68955.88000000",
                    "volume": "38404.66835000"
                },
                {
                    "time": "11.03.2024 03:00:00",
                    "open": "68955.88000000",
                    "close": "72078.10000000",
                    "volume": "75292.82572600"
                },
                {
                    "time": "12.03.2024 03:00:00",
                    "open": "72078.10000000",
                    "close": "71452.01000000",
                    "volume": "68783.54669100"
                },
                {
                    "time": "13.03.2024 03:00:00",
                    "open": "71452.00000000",
                    "close": "73072.41000000",
                    "volume": "52659.71164700"
                },
                {
                    "time": "14.03.2024 03:00:00",
                    "open": "73072.40000000",
                    "close": "71388.94000000",
                    "volume": "71757.62874600"
                },
                {
                    "time": "15.03.2024 03:00:00",
                    "open": "71388.94000000",
                    "close": "69499.85000000",
                    "volume": "103334.03546000"
                },
                {
                    "time": "16.03.2024 03:00:00",
                    "open": "69499.84000000",
                    "close": "65300.63000000",
                    "volume": "55926.95336000"
                },
                {
                    "time": "17.03.2024 03:00:00",
                    "open": "65300.64000000",
                    "close": "68393.48000000",
                    "volume": "49742.21589000"
                },
                {
                    "time": "18.03.2024 03:00:00",
                    "open": "68393.47000000",
                    "close": "67609.99000000",
                    "volume": "55691.08088000"
                },
                {
                    "time": "19.03.2024 03:00:00",
                    "open": "67610.00000000",
                    "close": "61937.40000000",
                    "volume": "101005.32487000"
                },
                {
                    "time": "20.03.2024 03:00:00",
                    "open": "61937.41000000",
                    "close": "67840.51000000",
                    "volume": "90420.58592000"
                },
                {
                    "time": "21.03.2024 03:00:00",
                    "open": "67840.51000000",
                    "close": "65501.27000000",
                    "volume": "53357.48002000"
                },
                {
                    "time": "22.03.2024 03:00:00",
                    "open": "65501.28000000",
                    "close": "63796.64000000",
                    "volume": "51482.37821000"
                },
                {
                    "time": "23.03.2024 03:00:00",
                    "open": "63796.64000000",
                    "close": "63990.01000000",
                    "volume": "26410.11409000"
                },
                {
                    "time": "24.03.2024 03:00:00",
                    "open": "63990.02000000",
                    "close": "67209.99000000",
                    "volume": "31395.78015000"
                },
                {
                    "time": "25.03.2024 03:00:00",
                    "open": "67210.00000000",
                    "close": "69880.01000000",
                    "volume": "53431.14486000"
                },
                {
                    "time": "26.03.2024 03:00:00",
                    "open": "69880.00000000",
                    "close": "69988.00000000",
                    "volume": "38934.38417000"
                },
                {
                    "time": "27.03.2024 03:00:00",
                    "open": "69987.99000000",
                    "close": "69469.99000000",
                    "volume": "49119.35685000"
                },
                {
                    "time": "28.03.2024 03:00:00",
                    "open": "69469.99000000",
                    "close": "70780.60000000",
                    "volume": "35439.03239000"
                },
                {
                    "time": "29.03.2024 03:00:00",
                    "open": "70780.60000000",
                    "close": "69850.54000000",
                    "volume": "25445.08353000"
                },
                {
                    "time": "30.03.2024 03:00:00",
                    "open": "69850.53000000",
                    "close": "69582.18000000",
                    "volume": "13644.61142000"
                },
                {
                    "time": "31.03.2024 03:00:00",
                    "open": "69582.17000000",
                    "close": "71280.01000000",
                    "volume": "19396.34433000"
                },
                {
                    "time": "01.04.2024 03:00:00",
                    "open": "71280.00000000",
                    "close": "69649.80000000",
                    "volume": "41445.32039000"
                },
                {
                    "time": "02.04.2024 03:00:00",
                    "open": "69649.81000000",
                    "close": "65463.99000000",
                    "volume": "71799.82793000"
                },
                {
                    "time": "03.04.2024 03:00:00",
                    "open": "65463.99000000",
                    "close": "65963.28000000",
                    "volume": "39887.21778000"
                },
                {
                    "time": "04.04.2024 03:00:00",
                    "open": "65963.27000000",
                    "close": "68487.79000000",
                    "volume": "41510.48453000"
                },
                {
                    "time": "05.04.2024 03:00:00",
                    "open": "68487.80000000",
                    "close": "67820.62000000",
                    "volume": "37915.23073000"
                },
                {
                    "time": "06.04.2024 03:00:00",
                    "open": "67820.63000000",
                    "close": "68896.00000000",
                    "volume": "20134.28919000"
                },
                {
                    "time": "07.04.2024 03:00:00",
                    "open": "68896.00000000",
                    "close": "69360.39000000",
                    "volume": "21534.74433000"
                },
                {
                    "time": "08.04.2024 03:00:00",
                    "open": "69360.38000000",
                    "close": "71620.00000000",
                    "volume": "45723.87624000"
                },
                {
                    "time": "09.04.2024 03:00:00",
                    "open": "71620.00000000",
                    "close": "69146.00000000",
                    "volume": "39293.90242000"
                },
                {
                    "time": "10.04.2024 03:00:00",
                    "open": "69146.00000000",
                    "close": "70631.08000000",
                    "volume": "42006.02377000"
                },
                {
                    "time": "11.04.2024 03:00:00",
                    "open": "70631.08000000",
                    "close": "70006.23000000",
                    "volume": "31917.25595000"
                },
                {
                    "time": "12.04.2024 03:00:00",
                    "open": "70006.22000000",
                    "close": "67116.52000000",
                    "volume": "56072.86229000"
                },
                {
                    "time": "13.04.2024 03:00:00",
                    "open": "67116.52000000",
                    "close": "63924.51000000",
                    "volume": "71395.22019000"
                },
                {
                    "time": "14.04.2024 03:00:00",
                    "open": "63924.52000000",
                    "close": "65661.84000000",
                    "volume": "61599.17818000"
                },
                {
                    "time": "15.04.2024 03:00:00",
                    "open": "65661.85000000",
                    "close": "63419.99000000",
                    "volume": "52389.53069000"
                },
                {
                    "time": "16.04.2024 03:00:00",
                    "open": "63419.99000000",
                    "close": "63793.39000000",
                    "volume": "53435.29331000"
                },
                {
                    "time": "17.04.2024 03:00:00",
                    "open": "63793.40000000",
                    "close": "61277.37000000",
                    "volume": "50610.54509000"
                },
                {
                    "time": "18.04.2024 03:00:00",
                    "open": "61277.38000000",
                    "close": "63470.08000000",
                    "volume": "43601.60918000"
                },
                {
                    "time": "19.04.2024 03:00:00",
                    "open": "63470.09000000",
                    "close": "63818.01000000",
                    "volume": "69774.30271000"
                },
                {
                    "time": "20.04.2024 03:00:00",
                    "open": "63818.01000000",
                    "close": "64940.59000000",
                    "volume": "23137.42975000"
                },
                {
                    "time": "21.04.2024 03:00:00",
                    "open": "64940.58000000",
                    "close": "64941.15000000",
                    "volume": "19316.42152000"
                },
                {
                    "time": "22.04.2024 03:00:00",
                    "open": "64941.15000000",
                    "close": "66819.32000000",
                    "volume": "31397.99371000"
                },
                {
                    "time": "23.04.2024 03:00:00",
                    "open": "66819.32000000",
                    "close": "66414.00000000",
                    "volume": "22599.90004000"
                },
                {
                    "time": "24.04.2024 03:00:00",
                    "open": "66414.00000000",
                    "close": "64289.59000000",
                    "volume": "33595.69637000"
                },
                {
                    "time": "25.04.2024 03:00:00",
                    "open": "64289.58000000",
                    "close": "64498.34000000",
                    "volume": "31341.46338000"
                },
                {
                    "time": "26.04.2024 03:00:00",
                    "open": "64498.33000000",
                    "close": "63770.01000000",
                    "volume": "27085.19346000"
                },
                {
                    "time": "27.04.2024 03:00:00",
                    "open": "63770.00000000",
                    "close": "63461.98000000",
                    "volume": "20933.06052000"
                },
                {
                    "time": "28.04.2024 03:00:00",
                    "open": "63461.98000000",
                    "close": "63118.62000000",
                    "volume": "16949.20005000"
                },
                {
                    "time": "29.04.2024 03:00:00",
                    "open": "63118.62000000",
                    "close": "63866.00000000",
                    "volume": "28150.22947000"
                },
                {
                    "time": "30.04.2024 03:00:00",
                    "open": "63866.00000000",
                    "close": "60672.00000000",
                    "volume": "54947.65535000"
                },
                {
                    "time": "01.05.2024 03:00:00",
                    "open": "60672.01000000",
                    "close": "58364.97000000",
                    "volume": "81166.46823000"
                },
                {
                    "time": "02.05.2024 03:00:00",
                    "open": "58364.97000000",
                    "close": "59060.61000000",
                    "volume": "47583.81961000"
                },
                {
                    "time": "03.05.2024 03:00:00",
                    "open": "59060.60000000",
                    "close": "62882.01000000",
                    "volume": "43628.40143000"
                },
                {
                    "time": "04.05.2024 03:00:00",
                    "open": "62882.01000000",
                    "close": "63892.04000000",
                    "volume": "24368.69282000"
                },
                {
                    "time": "05.05.2024 03:00:00",
                    "open": "63892.03000000",
                    "close": "64012.00000000",
                    "volume": "18526.75029000"
                },
                {
                    "time": "06.05.2024 03:00:00",
                    "open": "64012.00000000",
                    "close": "63165.19000000",
                    "volume": "34674.91949000"
                },
                {
                    "time": "07.05.2024 03:00:00",
                    "open": "63165.18000000",
                    "close": "62312.08000000",
                    "volume": "25598.79472000"
                },
                {
                    "time": "08.05.2024 03:00:00",
                    "open": "62312.07000000",
                    "close": "61193.03000000",
                    "volume": "26121.19004000"
                },
                {
                    "time": "09.05.2024 03:00:00",
                    "open": "61193.03000000",
                    "close": "63074.01000000",
                    "volume": "30660.80610000"
                },
                {
                    "time": "10.05.2024 03:00:00",
                    "open": "63074.00000000",
                    "close": "60799.99000000",
                    "volume": "36529.34025000"
                },
                {
                    "time": "11.05.2024 03:00:00",
                    "open": "60799.99000000",
                    "close": "60825.99000000",
                    "volume": "13374.56936000"
                },
                {
                    "time": "12.05.2024 03:00:00",
                    "open": "60825.99000000",
                    "close": "61483.99000000",
                    "volume": "12753.13236000"
                },
                {
                    "time": "13.05.2024 03:00:00",
                    "open": "61484.00000000",
                    "close": "62940.08000000",
                    "volume": "32733.41839000"
                },
                {
                    "time": "14.05.2024 03:00:00",
                    "open": "62940.09000000",
                    "close": "61577.49000000",
                    "volume": "29088.72041000"
                },
                {
                    "time": "15.05.2024 03:00:00",
                    "open": "61577.49000000",
                    "close": "66206.50000000",
                    "volume": "43559.74719000"
                },
                {
                    "time": "16.05.2024 03:00:00",
                    "open": "66206.51000000",
                    "close": "65235.21000000",
                    "volume": "31106.36710000"
                },
                {
                    "time": "17.05.2024 03:00:00",
                    "open": "65235.21000000",
                    "close": "67024.00000000",
                    "volume": "26292.23409000"
                },
                {
                    "time": "18.05.2024 03:00:00",
                    "open": "67024.00000000",
                    "close": "66915.20000000",
                    "volume": "14441.25774000"
                },
                {
                    "time": "19.05.2024 03:00:00",
                    "open": "66915.20000000",
                    "close": "66274.01000000",
                    "volume": "18025.30409000"
                },
                {
                    "time": "20.05.2024 03:00:00",
                    "open": "66274.00000000",
                    "close": "71446.62000000",
                    "volume": "50816.70110000"
                },
                {
                    "time": "21.05.2024 03:00:00",
                    "open": "71446.62000000",
                    "close": "70148.34000000",
                    "volume": "49607.43360000"
                },
                {
                    "time": "22.05.2024 03:00:00",
                    "open": "70148.34000000",
                    "close": "69166.62000000",
                    "volume": "27673.18026000"
                },
                {
                    "time": "23.05.2024 03:00:00",
                    "open": "69166.62000000",
                    "close": "67969.65000000",
                    "volume": "40513.17374000"
                },
                {
                    "time": "24.05.2024 03:00:00",
                    "open": "67969.66000000",
                    "close": "68549.99000000",
                    "volume": "28095.83664000"
                },
                {
                    "time": "25.05.2024 03:00:00",
                    "open": "68549.99000000",
                    "close": "69290.57000000",
                    "volume": "12130.39418000"
                },
                {
                    "time": "26.05.2024 03:00:00",
                    "open": "69290.56000000",
                    "close": "68507.67000000",
                    "volume": "11872.11797000"
                },
                {
                    "time": "27.05.2024 03:00:00",
                    "open": "68507.67000000",
                    "close": "69436.43000000",
                    "volume": "23136.92737000"
                },
                {
                    "time": "28.05.2024 03:00:00",
                    "open": "69436.43000000",
                    "close": "68398.39000000",
                    "volume": "32622.97042000"
                },
                {
                    "time": "29.05.2024 03:00:00",
                    "open": "68398.40000000",
                    "close": "67652.42000000",
                    "volume": "23159.83149000"
                },
                {
                    "time": "30.05.2024 03:00:00",
                    "open": "67652.41000000",
                    "close": "68352.17000000",
                    "volume": "28478.21840000"
                },
                {
                    "time": "31.05.2024 03:00:00",
                    "open": "68352.17000000",
                    "close": "67540.01000000",
                    "volume": "26690.32184000"
                },
                {
                    "time": "01.06.2024 03:00:00",
                    "open": "67540.01000000",
                    "close": "67766.85000000",
                    "volume": "8837.66133000"
                },
                {
                    "time": "02.06.2024 03:00:00",
                    "open": "67766.84000000",
                    "close": "67765.63000000",
                    "volume": "15426.32529000"
                },
                {
                    "time": "03.06.2024 03:00:00",
                    "open": "67765.62000000",
                    "close": "68809.90000000",
                    "volume": "29633.37400000"
                },
                {
                    "time": "04.06.2024 03:00:00",
                    "open": "68809.89000000",
                    "close": "70537.84000000",
                    "volume": "29619.78489000"
                },
                {
                    "time": "05.06.2024 03:00:00",
                    "open": "70537.83000000",
                    "close": "71108.00000000",
                    "volume": "28703.18082000"
                },
                {
                    "time": "06.06.2024 03:00:00",
                    "open": "71108.00000000",
                    "close": "70799.06000000",
                    "volume": "21842.00449000"
                },
                {
                    "time": "07.06.2024 03:00:00",
                    "open": "70799.06000000",
                    "close": "69355.60000000",
                    "volume": "35598.45045000"
                },
                {
                    "time": "08.06.2024 03:00:00",
                    "open": "69355.60000000",
                    "close": "69310.46000000",
                    "volume": "9773.82967000"
                },
                {
                    "time": "09.06.2024 03:00:00",
                    "open": "69310.46000000",
                    "close": "69648.14000000",
                    "volume": "9890.56709000"
                },
                {
                    "time": "10.06.2024 03:00:00",
                    "open": "69648.15000000",
                    "close": "69540.00000000",
                    "volume": "17122.66941000"
                },
                {
                    "time": "11.06.2024 03:00:00",
                    "open": "69540.00000000",
                    "close": "67314.24000000",
                    "volume": "41436.01588000"
                },
                {
                    "time": "12.06.2024 03:00:00",
                    "open": "67314.23000000",
                    "close": "68263.99000000",
                    "volume": "37175.32356000"
                },
                {
                    "time": "13.06.2024 03:00:00",
                    "open": "68263.98000000",
                    "close": "66773.01000000",
                    "volume": "29079.55571000"
                },
                {
                    "time": "14.06.2024 03:00:00",
                    "open": "66773.01000000",
                    "close": "66043.99000000",
                    "volume": "28408.18797000"
                },
                {
                    "time": "15.06.2024 03:00:00",
                    "open": "66043.99000000",
                    "close": "66228.25000000",
                    "volume": "11451.80242000"
                },
                {
                    "time": "16.06.2024 03:00:00",
                    "open": "66228.25000000",
                    "close": "66676.87000000",
                    "volume": "9392.52223000"
                },
                {
                    "time": "17.06.2024 03:00:00",
                    "open": "66676.86000000",
                    "close": "66504.33000000",
                    "volume": "27386.16851000"
                },
                {
                    "time": "18.06.2024 03:00:00",
                    "open": "66504.33000000",
                    "close": "65175.32000000",
                    "volume": "42350.10244000"
                },
                {
                    "time": "19.06.2024 03:00:00",
                    "open": "65175.32000000",
                    "close": "64974.37000000",
                    "volume": "20060.79576000"
                },
                {
                    "time": "20.06.2024 03:00:00",
                    "open": "64974.37000000",
                    "close": "64869.99000000",
                    "volume": "24265.29031000"
                },
                {
                    "time": "21.06.2024 03:00:00",
                    "open": "64869.99000000",
                    "close": "64143.56000000",
                    "volume": "25993.56442000"
                },
                {
                    "time": "22.06.2024 03:00:00",
                    "open": "64143.56000000",
                    "close": "64262.01000000",
                    "volume": "7308.95542000"
                },
                {
                    "time": "23.06.2024 03:00:00",
                    "open": "64262.01000000",
                    "close": "63210.01000000",
                    "volume": "8224.45447000"
                },
                {
                    "time": "24.06.2024 03:00:00",
                    "open": "63210.01000000",
                    "close": "60293.30000000",
                    "volume": "52161.35414000"
                },
                {
                    "time": "25.06.2024 03:00:00",
                    "open": "60293.30000000",
                    "close": "61806.01000000",
                    "volume": "31189.24361000"
                },
                {
                    "time": "26.06.2024 03:00:00",
                    "open": "61806.01000000",
                    "close": "60864.99000000",
                    "volume": "22485.66463000"
                },
                {
                    "time": "27.06.2024 03:00:00",
                    "open": "60864.98000000",
                    "close": "61706.47000000",
                    "volume": "18344.28631000"
                },
                {
                    "time": "28.06.2024 03:00:00",
                    "open": "61706.46000000",
                    "close": "60427.84000000",
                    "volume": "24821.19255000"
                },
                {
                    "time": "29.06.2024 03:00:00",
                    "open": "60427.84000000",
                    "close": "60986.68000000",
                    "volume": "11509.55904000"
                },
                {
                    "time": "30.06.2024 03:00:00",
                    "open": "60986.68000000",
                    "close": "62772.01000000",
                    "volume": "17326.30136000"
                },
                {
                    "time": "01.07.2024 03:00:00",
                    "open": "62772.01000000",
                    "close": "62899.99000000",
                    "volume": "24547.10538000"
                },
                {
                    "time": "02.07.2024 03:00:00",
                    "open": "62900.00000000",
                    "close": "62135.47000000",
                    "volume": "18573.11875000"
                },
                {
                    "time": "03.07.2024 03:00:00",
                    "open": "62135.46000000",
                    "close": "60208.58000000",
                    "volume": "32160.11127000"
                },
                {
                    "time": "04.07.2024 03:00:00",
                    "open": "60208.57000000",
                    "close": "57050.01000000",
                    "volume": "54568.77276000"
                },
                {
                    "time": "05.07.2024 03:00:00",
                    "open": "57050.02000000",
                    "close": "56628.79000000",
                    "volume": "81348.24756000"
                },
                {
                    "time": "06.07.2024 03:00:00",
                    "open": "56628.79000000",
                    "close": "58230.13000000",
                    "volume": "21651.31558000"
                },
                {
                    "time": "07.07.2024 03:00:00",
                    "open": "58230.13000000",
                    "close": "55857.81000000",
                    "volume": "19118.93918000"
                },
                {
                    "time": "08.07.2024 03:00:00",
                    "open": "55857.81000000",
                    "close": "56714.62000000",
                    "volume": "48090.20490000"
                },
                {
                    "time": "09.07.2024 03:00:00",
                    "open": "56714.61000000",
                    "close": "58050.00000000",
                    "volume": "27732.20788000"
                },
                {
                    "time": "10.07.2024 03:00:00",
                    "open": "58050.00000000",
                    "close": "57725.85000000",
                    "volume": "24951.73799000"
                },
                {
                    "time": "11.07.2024 03:00:00",
                    "open": "57725.85000000",
                    "close": "57339.89000000",
                    "volume": "29761.05735000"
                },
                {
                    "time": "12.07.2024 03:00:00",
                    "open": "57339.89000000",
                    "close": "57889.10000000",
                    "volume": "23652.45690000"
                },
                {
                    "time": "13.07.2024 03:00:00",
                    "open": "57889.09000000",
                    "close": "59204.02000000",
                    "volume": "15357.74519000"
                },
                {
                    "time": "14.07.2024 03:00:00",
                    "open": "59204.01000000",
                    "close": "60797.91000000",
                    "volume": "21178.33907000"
                },
                {
                    "time": "15.07.2024 03:00:00",
                    "open": "60797.91000000",
                    "close": "64724.14000000",
                    "volume": "38690.97820000"
                },
                {
                    "time": "16.07.2024 03:00:00",
                    "open": "64724.06000000",
                    "close": "65043.99000000",
                    "volume": "42530.52915000"
                },
                {
                    "time": "17.07.2024 03:00:00",
                    "open": "65044.00000000",
                    "close": "64087.99000000",
                    "volume": "29567.52954000"
                },
                {
                    "time": "18.07.2024 03:00:00",
                    "open": "64087.99000000",
                    "close": "63987.92000000",
                    "volume": "22568.72250000"
                },
                {
                    "time": "19.07.2024 03:00:00",
                    "open": "63987.92000000",
                    "close": "66660.00000000",
                    "volume": "35634.72739000"
                },
                {
                    "time": "20.07.2024 03:00:00",
                    "open": "66660.01000000",
                    "close": "67139.96000000",
                    "volume": "14386.92434000"
                },
                {
                    "time": "21.07.2024 03:00:00",
                    "open": "67139.97000000",
                    "close": "68165.34000000",
                    "volume": "21819.11191000"
                },
                {
                    "time": "22.07.2024 03:00:00",
                    "open": "68165.35000000",
                    "close": "67532.01000000",
                    "volume": "21451.04303000"
                },
                {
                    "time": "23.07.2024 03:00:00",
                    "open": "67532.00000000",
                    "close": "65936.01000000",
                    "volume": "31406.15316000"
                },
                {
                    "time": "24.07.2024 03:00:00",
                    "open": "65936.00000000",
                    "close": "65376.00000000",
                    "volume": "23082.56277000"
                },
                {
                    "time": "25.07.2024 03:00:00",
                    "open": "65376.01000000",
                    "close": "65799.95000000",
                    "volume": "35126.42934000"
                },
                {
                    "time": "26.07.2024 03:00:00",
                    "open": "65799.95000000",
                    "close": "67907.99000000",
                    "volume": "24244.36023000"
                },
                {
                    "time": "27.07.2024 03:00:00",
                    "open": "67908.00000000",
                    "close": "67896.50000000",
                    "volume": "31710.21921000"
                },
                {
                    "time": "28.07.2024 03:00:00",
                    "open": "67896.49000000",
                    "close": "68249.88000000",
                    "volume": "10868.69394000"
                },
                {
                    "time": "29.07.2024 03:00:00",
                    "open": "68249.88000000",
                    "close": "66784.69000000",
                    "volume": "36467.29633000"
                },
                {
                    "time": "30.07.2024 03:00:00",
                    "open": "66784.68000000",
                    "close": "66188.00000000",
                    "volume": "23132.25441000"
                },
                {
                    "time": "31.07.2024 03:00:00",
                    "open": "66188.00000000",
                    "close": "64628.00000000",
                    "volume": "22625.43905000"
                },
                {
                    "time": "01.08.2024 03:00:00",
                    "open": "64628.01000000",
                    "close": "65354.02000000",
                    "volume": "35542.26854000"
                },
                {
                    "time": "02.08.2024 03:00:00",
                    "open": "65354.02000000",
                    "close": "61498.33000000",
                    "volume": "38820.42937000"
                },
                {
                    "time": "03.08.2024 03:00:00",
                    "open": "61498.34000000",
                    "close": "60697.99000000",
                    "volume": "28034.71567000"
                },
                {
                    "time": "04.08.2024 03:00:00",
                    "open": "60697.99000000",
                    "close": "58161.00000000",
                    "volume": "31616.52003000"
                },
                {
                    "time": "05.08.2024 03:00:00",
                    "open": "58161.00000000",
                    "close": "54018.81000000",
                    "volume": "162065.59186000"
                },
                {
                    "time": "06.08.2024 03:00:00",
                    "open": "54018.82000000",
                    "close": "56022.01000000",
                    "volume": "55884.77676000"
                },
                {
                    "time": "07.08.2024 03:00:00",
                    "open": "56022.00000000",
                    "close": "55134.16000000",
                    "volume": "44269.37684000"
                },
                {
                    "time": "08.08.2024 03:00:00",
                    "open": "55133.76000000",
                    "close": "61685.99000000",
                    "volume": "48349.52949000"
                },
                {
                    "time": "09.08.2024 03:00:00",
                    "open": "61686.00000000",
                    "close": "60884.00000000",
                    "volume": "9363.89006000"
                }
            ]

# Verileri DataFrame'e dönüştürün
df = pd.DataFrame(data)
df['time'] = pd.to_datetime(df['time'], format='%d.%m.%Y %H:%M:%S')
df['open'] = df['open'].astype(float)
df['close'] = df['close'].astype(float)


def calculate_lunar_phase(date):
    moon = ephem.Moon(date)
    phase = moon.phase / 100  # Ay fazını 0 ile 1 arasında bir değere çevirme
    return phase

df['lunar_phase'] = df['time'].apply(calculate_lunar_phase)

def categorize_phase(phase):
    if 0 <= phase < 0.25:
        return "0-0.25"
    elif 0.25 <= phase < 0.5:
        return "0.25-0.5"
    elif 0.5 <= phase < 0.75:
        return "0.5-0.75"
    elif 0.75 <= phase <= 1:
        return "0.75-1.0"

df['phase_category'] = df['lunar_phase'].apply(categorize_phase)

df['price_change'] = df['close'] - df['open']
df['price_trend'] = df['price_change'].apply(lambda x: 'Artis' if x > 0 else 'Azalma')

# Faz kategorisine göre gruplayın ve her bir kategoride kaç kez artış veya azalma olduğunu hesaplayın
trend_summary = df.groupby(['phase_category', 'price_trend']).size().unstack(fill_value=0)

sonuc=json.dumps(trend_summary.to_dict(),indent=4)

print(sonuc)